// kava4
// kava-protocol
function rewardPeriodsPerYear(e){return 314496e11/+e}const FACTOR_SIX=1e6,FACTOR_EIGHT=1e8,BASE_URL="https://kava4.data5.kava.io";var usdFormatter=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),isKavaNativeAsset=e=>["ukava-a","usdx","hard","ukava","hard-a"].includes(e),totalLockedAndBorrowedByDenom=(e,t)=>{var{collateral:a,principal:o,accumulated_fees:r}=e.reduce(function(e,t){return Object.keys(t.cdp).forEach(function(a){["collateral","principal","accumulated_fees"].includes(a)&&(e[a]=+(e[a]||0)+ +t.cdp[a].amount)}),e},{});return{locked:isKavaNativeAsset(t)?+a/1e6:+a/1e8,borrowed:+o/1e6,fees:+r/1e6}},totalAmountOnPlatformByDenom=(e,t)=>{const a=e.result.find(e=>e.current_supply.denom===t);let o=0;return a&&(o=+a.current_supply.amount),o},getRewardApyForDenom=(e,t,a,o)=>{const r=o.result;let n=0,s=0;if(r&&r.rewards&&r.rewards.length>0){const t=o.result.rewards.find(t=>t.collateral_type.toUpperCase()===e.toUpperCase());n=+t.available_rewards.amount,s=+t.duration}const l=100*+(n/1e6*rewardPeriodsPerYear(s)*+a/t),d=usdFormatter.format(l);return d.slice(1,d.length)+"%"},usdxDebtLimitByDenom=(e,t)=>{const a=t.result.collateral_params.find(t=>t.type.toUpperCase()===e.toUpperCase());return a&&a.debt_limit?+a.debt_limit.amount/1e6:0},setUsdxAmount=(e,t,a,o)=>{if(e&&t){const t=a+o;return t>e?+e:+t}},setDenomTotalLocked=(e,t,a,o)=>{const r=+(e/t)*a/1e6,n=usdFormatter.format(r)+"M";document.getElementById(o).innerHTML=n},setDenomTotalBorrowed=(e,t)=>{const a=e/1e6,o=usdFormatter.format(a)+"M";document.getElementById(t).innerHTML=o},setDenomAPY=(e,t,a,o,r,n)=>{const s=getRewardApyForDenom(a,+e*+t,o,r);document.getElementById(n).innerHTML=s},setKavaChainDenomInfo=async(e,t,a,o,r,n,s,l,d,i,c)=>{"ukava"===a&&(o=l);let u=e.find(e=>e.denom===a).amount;u&&setDenomTotalLocked(u,1e6,o,r),n&&setDenomTotalBorrowed(n,s),o&&l&&d&&i&&t&&c&&i&&setDenomAPY(o,d,i,l,t,c)},setBep3DenomInfo=async(e,t,a,o,r,n,s,l,d,i,c,u)=>{let m=+totalAmountOnPlatformByDenom(t,r)/1e8*o,p=e.find(e=>e.denom===r).amount;return p&&setDenomTotalLocked(p,1e8,o,n),s&&setDenomTotalBorrowed(s,l),o&&d&&i&&c&&a&&u&&setDenomAPY(o,i,c,d,a,u),{denomTotalSupplyValue:m}},getValueRewardsDistributedForDenom=(e,t,a,o)=>{if(!o)return 0;let r=0;if(e.result){const a=e.result.find(e=>e.collateral_type.toUpperCase()===t.toUpperCase()),n=(Date.now()-o.getTime())/1e3;r=+a.reward.amount*+n/1e6}return+r*+a},getCollateralPrice=e=>{return+(e&&e.result).price},updateDisplayValues=async()=>{const[e,t,a,o,r,n,s,l,d,i,c,u,m,p,w,B,D,A,b]=await Promise.all([fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=KAVAUSDT"),fetch(BASE_URL+"/incentive/rewardperiods"),fetch(BASE_URL+"/auth/accounts/kava1wq9ts6l7atfn45ryxrtg4a2gwegsh3xha9e6rp"),fetch(BASE_URL+"/bep3/supplies"),fetch(BASE_URL+"/bep3/parameters"),fetch(BASE_URL+"/cdp/parameters"),fetch(BASE_URL+"/incentive/parameters"),fetch(BASE_URL+"/cdp/cdps/collateralType/btcb-a"),fetch(BASE_URL+"/cdp/cdps/collateralType/busd-a"),fetch(BASE_URL+"/cdp/cdps/collateralType/xrpb-a"),fetch(BASE_URL+"/cdp/cdps/collateralType/bnb-a"),fetch(BASE_URL+"/cdp/cdps/collateralType/ukava-a"),fetch(BASE_URL+"/cdp/cdps/collateralType/hard-a"),fetch(BASE_URL+"/pricefeed/price/btc:usd"),fetch(BASE_URL+"/pricefeed/price/busd:usd"),fetch(BASE_URL+"/pricefeed/price/xrp:usd"),fetch(BASE_URL+"/pricefeed/price/bnb:usd"),fetch(BASE_URL+"/pricefeed/price/kava:usd"),fetch(BASE_URL+"/pricefeed/price/hard:usd")]),f=await e.json(),T=await t.json(),y=await a.json(),L=await o.json(),h=(await r.json(),await n.json()),U=await s.json(),R=await l.json(),S=await d.json(),k=await i.json(),g=await c.json(),_=await u.json(),E=await m.json(),P=await p.json(),v=await w.json(),x=await B.json(),C=await D.json(),j=await A.json(),V=await b.json(),F=await f.lastPrice,I=getValueRewardsDistributedForDenom(T,"bnb-a",F,new Date("2020-07-29T14:00:14.333506701Z"))+getValueRewardsDistributedForDenom(T,"busd-a",F,new Date("2020-11-09T14:00:14.333506701Z"))+getValueRewardsDistributedForDenom(T,"btcb-a",F,new Date("2020-11-16T14:00:14.333506701Z"))+getValueRewardsDistributedForDenom(T,"xrpb-a",F,new Date("2020-12-02T14:00:14.333506701Z"))+getValueRewardsDistributedForDenom(T,"ukava-a",F,new Date("2020-12-14T14:00:14.333506701Z"))+getValueRewardsDistributedForDenom(T,"hard-a",F,new Date("2021-01-15T14:00:14.333506701Z")),K=usdFormatter.format(I),Y=K.slice(1,K.length);document.getElementById("TOTAL-REWARDS-DISTRIBUTED").innerHTML=Y;const H=await y.result.value.coins,O=await totalLockedAndBorrowedByDenom(R.result,"btcb-a"),M=await totalLockedAndBorrowedByDenom(S.result,"busd-a"),N=await totalLockedAndBorrowedByDenom(k.result,"xrpb-a"),Z=await totalLockedAndBorrowedByDenom(g.result,"bnb-a"),X=await totalLockedAndBorrowedByDenom(_.result,"ukava-a"),q=await totalLockedAndBorrowedByDenom(E.result,"hard-a"),G=getCollateralPrice(P),W=getCollateralPrice(v),z=getCollateralPrice(x),J=getCollateralPrice(C),Q=getCollateralPrice(j),ee=getCollateralPrice(V);let te,ae,oe;O&&(te=O.locked,ae=O.borrowed,oe=O.fees);let re,ne,se,le=await usdxDebtLimitByDenom("BTCB-A",h),de=setUsdxAmount(le,O,ae,oe),ie=(await setBep3DenomInfo(H,L,U,G,"btcb","TL-BTC",de,"TB-BTC",F,te,"btcb-a","APY-BTC")).denomTotalSupplyValue;M&&(re=M.locked,ne=M.borrowed,se=M.fees);let ce,ue,me,pe=await usdxDebtLimitByDenom("BUSD-A",h),we=setUsdxAmount(pe,M,ne,se),Be=(await setBep3DenomInfo(H,L,U,W,"busd","TL-BUSD",we,"TB-BUSD",F,re,"busd-a","APY-BUSD")).denomTotalSupplyValue;N&&(ce=N.locked,ue=N.borrowed,me=N.fees);let De,Ae,be,fe=await usdxDebtLimitByDenom("XRPB-A",h),Te=setUsdxAmount(fe,N,ue,me),ye=(await setBep3DenomInfo(H,L,U,z,"xrpb","TL-XRP",Te,"TB-XRP",F,ce,"xrpb-a","APY-XRP")).denomTotalSupplyValue;Z&&(De=Z.locked,Ae=Z.borrowed,be=Z.fees);let Le,he,Ue,Re=await usdxDebtLimitByDenom("BNB-A",h),Se=setUsdxAmount(Re,Z,Ae,be),ke=(await setBep3DenomInfo(H,L,U,J,"bnb","TL-BNB",Se,"TB-BNB",F,De,"bnb-a","APY-BNB")).denomTotalSupplyValue;X&&(Le=X.locked,he=X.borrowed,Ue=X.fees);let ge,_e,Ee,Pe=await usdxDebtLimitByDenom("UKAVA-A",h),ve=setUsdxAmount(Pe,X,he,Ue);await setKavaChainDenomInfo(H,U,"ukava",Q,"TL-KAVA",ve,"TB-KAVA",F,Le,"ukava-a","APY-KAVA"),q&&(ge=q.locked,_e=q.borrowed,Ee=q.fees);let xe=await usdxDebtLimitByDenom("HARD-A",h),Ce=setUsdxAmount(xe,q,_e,Ee);await setKavaChainDenomInfo(H,U,"hard",ee,"TL-HARD",Ce,"TB-HARD",F,ge,"hard-a","APY-HARD");let je=ke+ie+Be+ye+(Se+de+we+Te+ve+Ce);const Ve=usdFormatter.format(je),Fe=Ve.slice(1,Ve.length);document.getElementById("TOTAL-VALUE-LOCKED").innerHTML=Fe,$(".metric-blur").css("background-color","transparent"),$(".metric-blur").addClass("without-after"),$(".api-metric").css({display:"block","text-align":"center"})},main=async()=>{Promise.all(await updateDisplayValues(),await sleep(6e4),main())},sleep=(e=1e4)=>new Promise(t=>setTimeout(t,e));main();

// hard-protocol
function formatNumbers(e,a=2){return(+e).toFixed(a).toString().replace(/^([-+]?)(0?)(\d+)(.?)(\d+)$/g,function(e,a,t,n,r,s){var i=function(e){return e.split("").reverse().join("")},o=function(e){var a=i(e).match(/.{1,3}/g).join(",");return i(a)};return a+(r?o(n)+r+s:o(n+s))})}function rewardPeriodsPerYear(e){return 31536e3*+e/1e6}const FACTOR_SIX=1e6,FACTOR_EIGHT=1e8,BASE_URL="https://kava4.data5.kava.io";var usdFormatter=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});const KAVA_DENOM="ukava",HARD_DENOM="hard",USDX_DENOM="usdx",BNB_DENOM="bnb",BTC_DENOM="btcb",XRP_DENOM="xrpb",BUSD_DENOM="busd";var getBalanceForDenom=(e,a)=>{const t=a.find(a=>a.denom===e);return t?+t.amount:0},formatPercentage=e=>e+"%",convertToCoin=e=>{const a=e.denom,t=+e.amount;let n;switch(a){case"bnb":case"btcb":case"xrpb":case"busd":n=t/1e8;break;default:n=t/1e6}return n},getModuleBalances=async e=>e.find(e=>"harvest"===e.value.name).value.coins,getRewardPerYearByDenom=async e=>{return e.liquidity_provider_schedules.map(e=>{const a=rewardPeriodsPerYear(e.rewards_per_second.amount);return{denom:e.deposit_denom,amount:a}})},setApyByDenom=(e,a,t)=>t.map(n=>{const r=a.find(e=>e.name===n.denom),s=e.find(e=>e.denom===n.denom),i=convertToCoin(s),o=t.find(e=>e.denom===n.denom),c=a.find(e=>"hard"===e.name).price,u=o.amount*c,l=i*r.price,d=(formatNumbers(u/l*100),formatPercentage(formatNumbers(u/l*100)));return{denom:n.denom,apy:d}}),getKavaPrice=async()=>{const e=await fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=KAVAUSDT"),a=await e.json();return{price:a.lastPrice,percentChange:a.priceChangePercent}},getValueRewardsDistributed=async e=>{const a=await fetch("https://kava4.data5.kava.io/incentive/rewardperiods"),t=await a.json(),n=new Date("2020-07-29T14:00:14.333506701Z"),r=(Date.now()-n.getTime())/1e3;let s=0;if(t.result){s=+t.result.find(e=>"bnb-a"===e.collateral_type).reward.amount*+r/1e6}return+s*+e},getTotalValues=async(e,a)=>{var t=new Map;t.set("usdx",1e6),t.set("ukava",1e6),t.set("hard",1e6),t.set("bnb",1e8),t.set("btcb",1e8),t.set("xrpb",1e8),t.set("busd",1e8);var n=[];if(a&&a.length>0){const r="kava16zr7aqvk473073s6a5jgaxus6hx2vn5laum9s3",s=a.find(e=>e.value.address===r).value.coins;for(coin of s){const a=+coin.amount/t.get(coin.denom)*+e.find(e=>e.name===coin.denom).price;n.push({denom:coin.denom,total_value:a})}}return n},setTotalValue=async(e,a,t)=>{const n=t.find(a=>a.denom===e).total_value;return n&&(document.getElementById(a).innerHTML=usdFormatter.format(n)),n},setApyValue=(e,a,t)=>{const n=t.find(a=>a.denom===e);document.getElementById(a).innerHTML=n.apy},updateDisplayValues=async()=>{const[e,a,t,n,r,s,i]=await Promise.all([fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=HARDUSDT"),fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=KAVAUSDT"),fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=BNBUSDT"),fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=BTCUSDT"),fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=XRPUSDT"),fetch("https://kava4.data5.kava.io/harvest/parameters"),fetch(`${BASE_URL}/harvest/accounts`)]),o=await e.json(),c=await a.json(),u=await t.json(),l=await n.json(),d=await r.json(),m=await s.json(),p=await i.json(),b=await m.result,w=await p.result,h=[{name:"hard",price:await o.lastPrice},{name:"ukava",price:await c.lastPrice},{name:"bnb",price:await u.lastPrice},{name:"btcb",price:await l.lastPrice},{name:"busd",price:1},{name:"xrpb",price:await d.lastPrice},{name:"usdx",price:1}],v=h.find(e=>"hard"===e.name).price,y=await getTotalHardAvailable(b),f=usdFormatter.format(y*v),T=f.slice(0,f.length);document.getElementById("total-hard-dist").innerHTML=T;const A=await getTotalValues(h,w),D=await setTotalValue("bnb","TL-BNB",A)+await setTotalValue("ukava","TL-KAVA",A)+await setTotalValue("usdx","TL-USDX",A)+await setTotalValue("hard","TL-HARD",A)+await setTotalValue("btcb","TL-BTC",A)+await setTotalValue("busd","TL-BUSD",A)+await setTotalValue("xrpb","TL-XRP",A);document.getElementById("TAV").innerHTML=usdFormatter.format(D);const g=await getModuleBalances(w),P=(getBalanceForDenom("bnb",g),await getRewardPerYearByDenom(b)),B=setApyByDenom(g,h,P);setApyValue("bnb","APY-BNB",B),setApyValue("hard","APY-HARD",B),setApyValue("ukava","APY-KAVA",B),setApyValue("usdx","APY-USDX",B),setApyValue("btcb","APY-BTC",B),setApyValue("xrpb","APY-XRP",B),setApyValue("busd","APY-BUSD",B),$(".metric-blur").css("background-color","transparent"),$(".metric-blur").addClass("without-after"),$(".api-metric").css({display:"block","text-align":"center"})},getTotalHardAvailable=async e=>{let a=0;if(e)for(lps of e.liquidity_provider_schedules){const e=Date.parse(lps.start);a+=(Date.now()-e)/1e3*+lps.rewards_per_second.amount}return a/1e6},main=async()=>{await updateDisplayValues(),await sleep(6e4),main()},sleep=(e=1e4)=>new Promise(a=>setTimeout(a,e));main(),setTimeout(async function(){const e=await getKavaPrice();await getValueRewardsDistributed(+e.price)},2e3);

// kava stats
function rPPY(t){return 314496e11/+t}const FACTOR_SIX=1e6,FACTOR_EIGHT=1e8,BASE_URL="https://kava4.data5.kava.io",BINANACE_URL="https://api.binance.com/api/v3";var usdF=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),formatMM=t=>{const e=t/1e6;return usdF.format(e)+"M"},formatMNDOL=t=>{const e=usdF.format(t);return e.slice(1,e.length-3)},formatMNDS=t=>{const e=usdF.format(t);return e.slice(1,e.length)},isKNA=t=>["ukava-a","usdx","hard","ukava","hard-a"].includes(t),denomLabel=t=>{switch(t){case"xrpb":return"XRP";case"ukava":return"KAVA";case"btcb":return"BTC";default:return t.toUpperCase()}},tLABBD=async t=>{let e=BASE_URL+`/cdp/cdps/collateralType/${t}`,s=await fetch(e),a=await s.json(),r=a&&a.result;var{collateral:D,principal:d,accumulated_fees:c}=r.reduce(function(t,e){return Object.keys(e.cdp).forEach(function(s){["collateral","principal","accumulated_fees"].includes(s)&&(t[s]=+(t[s]||0)+ +e.cdp[s].amount)}),t},{});return{locked:isKNA(t)?+D/1e6:+D/1e8,borrowed:+d/1e6,fees:+c/1e6}},bAOP=t=>{return+t.result.find(t=>"bnb"===t.current_supply.denom).current_supply.amount},tAOPBD=(t,e)=>{return+t.result.find(t=>t.denom===e).amount},getRAFD=(t,e,s,a)=>{const r=a.result;let D=0,d=0;if(r&&r.rewards&&r.rewards.length>0){const e=a.result.rewards.find(e=>e.collateral_type.toUpperCase()===t.toUpperCase());D=+e.available_rewards.amount,d=+e.duration}const c=100*+(D/1e6*rPPY(d)*+s/e),n=usdF.format(c);return n.slice(1,n.length)+"%"},uDLBD=(t,e)=>{const s=e.result.collateral_params.find(e=>e.type.toUpperCase()===t.toUpperCase());return s&&s.debt_limit?+s.debt_limit.amount/1e6:0},setUA=(t,e,s)=>{if(t&&e){const a=e+s;return a>t?+t:+a}},supplyLBD=(t,e)=>{const s=e.result.asset_params.find(e=>e.denom.toUpperCase()===t.toUpperCase());return s&&s.supply_limit&&s.supply_limit.limit?+s.supply_limit.limit/1e8:0},setDTS=(t,e,s,a)=>{const r=+(t/e)*s;return setDV(formatMNDS(r),a),r},setDAPY=(t,e,s,a,r,D)=>{const d=getRAFD(s,+t*+e,a,r);setDV(d,D)},setDTSV=async(t,e,s,a)=>{let r,D;r="bnb"===a?bAOP(t):tAOPBD(t,a);let d=+(D=isKNA(a)?+r/1e6:+r/1e8)*s,c=supplyLBD(a,e),n={};return n[`${a}Usd`]=d,n[`${a}MC`]=formatMM(d),n[`${a}Supply`]=formatMNDOL(D)+" "+denomLabel(a),n[`${a}AL`]=formatMNDOL(c)+" "+denomLabel(a),n},getRPD=async()=>{const t=await fetch("https://kava4.data5.kava.io/incentive/rewardperiods");return await t.json()},getVRDFD=(t,e,s,a)=>{if(!a)return 0;let r=0;if(t.result){const s=t.result.find(t=>t.collateral_type.toUpperCase()===e.toUpperCase()),D=(Date.now()-a.getTime())/1e3;r=+s.reward.amount*+D/1e6}return+r*+s},setUABD=(t,e,s)=>{const a=formatMNDOL(e),r=formatMNDOL(s),D=(100*(+e.toFixed(0)/+s.toFixed(0)).toFixed(3)).toFixed(2)+"%";$(`.percent-line-usdx-${t}`).css("width",D),setDV(a,`tb-${t}`),setDV(r,`bl-${t}`)},setDPD=(t,e)=>{let s;0>+t?(s=usdF.format(t).replace("$","")+"%",setDC("red",e)):(s="+"+formatMNDS(t)+"%",setDC("green",e)),setDV(s,e)},setUAL=t=>formatMNDOL(+t.result.global_debt_limit.amount/1e6),setDV=(t,e)=>{$(`#${e}`).last().html(t),$(`#${e}`).first().html(t)},setDC=(t,e)=>{$(`#${e}`).css({color:t})},updateDV=async()=>{const[t,e,s,a,r,D,d]=await Promise.all([fetch(BINANACE_URL+"/ticker/24hr?symbol=KAVAUSDT"),fetch(BINANACE_URL+"/ticker/24hr?symbol=HARDUSDT"),fetch(BINANACE_URL+"/ticker/24hr?symbol=BNBUSDT"),fetch(BINANACE_URL+"/ticker/24hr?symbol=BUSDUSDT"),fetch(BINANACE_URL+"/ticker/24hr?symbol=BTCUSDT"),fetch(BINANACE_URL+"/ticker/24hr?symbol=XRPUSDT"),fetch("https://api.coingecko.com/api/v3/coins/usdx")]),c=await t.json(),n=await e.json(),o=await s.json(),u=await a.json(),m=await r.json(),b=await D.json(),p=await d.json(),i=+c.lastPrice,l=await getRPD(),V=getVRDFD(l,"bnb-a",i,new Date("2020-07-29T14:00:14.333506701Z")),f=getVRDFD(l,"busd-a",i,new Date("2020-11-09T14:00:14.333506701Z")),A=getVRDFD(l,"btcb-a",i,new Date("2020-11-16T14:00:14.333506701Z")),h=getVRDFD(l,"xrpb-a",i,new Date("2020-12-02T14:00:14.333506701Z")),w=getVRDFD(l,"ukava-a",i,new Date("2020-12-14T14:00:14.333506701Z")),P=getVRDFD(l,"hard-a",i,new Date("2020-12-28T14:00:14.333506701Z")),[U,B,x,F,S,k]=await Promise.all([fetch(BASE_URL+"/auth/accounts/kava1wq9ts6l7atfn45ryxrtg4a2gwegsh3xha9e6rp"),fetch(BASE_URL+"/supply/total"),fetch(BASE_URL+"/bep3/supplies"),fetch(BASE_URL+"/bep3/parameters"),fetch(BASE_URL+"/cdp/parameters"),fetch(BASE_URL+"/incentive/parameters")]),L=(await U.json()).result.value.coins,v=await B.json(),T=await x.json(),_=await F.json(),C=await S.json(),y=await k.json();let R,N,g,M=await tLABBD("bnb-a");M&&(R=M.locked,N=M.borrowed,g=M.fees);let E=await uDLBD("BNB-A",C),j=setUA(E,N,g),$=+o.lastPrice;const Y=+o.priceChangePercent;let{bnbUsd:O,bnbMC:I,bnbSupply:K,bnbAL:Z}=await setDTSV(T,_,$,"bnb");setDV(usdF.format($),"price-bnb"),setDPD(Y,"pc-bnb");let X=L.find(t=>"bnb"===t.denom).amount;const H=setDTS(X,1e8,$,"ts-bnb");setDTS(X,1e8,$,"ts-m-bnb"),setDV(usdF.format(V),"te-bnb"),setDV(usdF.format(V),"te-m-bnb"),setDAPY($,R,"bnb-a",i,y,"ea-bnb"),setDAPY($,R,"bnb-a",i,y,"ea-m-bnb"),setUABD("bnb",j,E);let q,G,z,J=await tLABBD("busd-a");J&&(q=J.locked,G=J.borrowed,z=J.fees);let Q=await uDLBD("BUSD-A",C),W=setUA(Q,G,z),tt=+u.lastPrice;const et=+u.priceChangePercent;let{busdUsd:st,busdMC:at,busdSupply:rt,busdAL:Dt}=await setDTSV(v,_,tt,"busd");setDV(usdF.format(tt),"price-busd"),setDPD(et,"pc-busd");let dt=L.find(t=>"busd"===t.denom).amount;const ct=setDTS(dt,1e8,tt,"ts-busd");setDTS(dt,1e8,tt,"ts-m-busd"),setDV(usdF.format(f),"te-busd"),setDV(usdF.format(f),"te-m-busd"),setDAPY(tt,q,"busd-a",i,y,"ea-busd"),setDAPY(tt,q,"busd-a",i,y,"ea-m-busd"),setUABD("busd",W,Q);let nt,ot,ut,mt=await tLABBD("btcb-a");mt&&(nt=mt.locked,ot=mt.borrowed,ut=mt.fees);let bt=await uDLBD("BTCB-A",C),pt=setUA(bt,ot,ut),it=+m.lastPrice;const lt=+m.priceChangePercent;let{btcbUsd:Vt,btcbMC:ft,btcbSupply:At,btcbAL:ht}=await setDTSV(v,_,it,"btcb");setDV(usdF.format(it),"price-btc"),setDPD(lt,"pc-btc");let wt=L.find(t=>"btcb"===t.denom).amount;const Pt=setDTS(wt,1e8,it,"ts-btc");setDTS(wt,1e8,it,"ts-m-btc"),setDV(usdF.format(A),"te-btc"),setDV(usdF.format(A),"te-m-btc"),setDAPY(it,nt,"btcb-a",i,y,"ea-btc"),setDAPY(it,nt,"btcb-a",i,y,"ea-m-btc"),setUABD("btc",pt,bt);let Ut,Bt,xt,Ft=await tLABBD("xrpb-a");Ft&&(Ut=Ft.locked,Bt=Ft.borrowed,xt=Ft.fees);let St=await uDLBD("XRPB-A",C),kt=setUA(St,Bt,xt),Lt=+b.lastPrice;const vt=+b.priceChangePercent;let{xrpbUsd:Tt,xrpbMC:_t,xrpbSupply:Ct,xrpbAL:yt}=await setDTSV(v,_,Lt,"xrpb");setDV(usdF.format(Lt),"price-xrp"),setDPD(vt,"pc-xrp");let Rt=L.find(t=>"xrpb"===t.denom).amount;const Nt=setDTS(Rt,1e8,Lt,"ts-xrp");setDTS(Rt,1e8,Lt,"ts-m-xrp"),setDV(usdF.format(h),"te-xrpb"),setDV(usdF.format(h),"te-m-xrpb"),setDAPY(Lt,Ut,"xrpb-a",i,y,"ea-xrp"),setDAPY(Lt,Ut,"xrpb-a",i,y,"ea-m-xrp"),setUABD("xrp",kt,St);let gt,Mt,Et,jt=await tLABBD("ukava-a");jt&&(gt=jt.locked,Mt=jt.borrowed,Et=jt.fees);let $t=await uDLBD("UKAVA-A",C),Yt=setUA($t,Mt,Et);const Ot=+c.priceChangePercent;let{ukavaUsd:It,ukavaMC:Kt,ukavaSupply:Zt}=await setDTSV(v,_,i,"ukava");setDV(usdF.format(i),"price-kava"),setDPD(Ot,"pc-kava");let Xt=L.find(t=>"ukava"===t.denom).amount;const Ht=setDTS(Xt,1e6,i,"ts-kava");setDTS(Xt,1e6,i,"ts-m-kava"),setDV(usdF.format(w),"te-kava"),setDV(usdF.format(w),"te-m-kava"),setDAPY(i,gt,"ukava-a",i,y,"ea-kava"),setDAPY(i,gt,"ukava-a",i,y,"ea-m-kava"),setUABD("kava",Yt,$t);let qt,Gt,zt,Jt=await tLABBD("hard-a");Jt&&(qt=Jt.locked,Gt=Jt.borrowed,zt=Jt.fees);let Qt=await uDLBD("HARD-A",C),Wt=setUA(Qt,Gt,zt),te=+n.lastPrice;const ee=+n.priceChangePercent;let{hardUsd:se,hardMC:ae,hardSupply:re}=await setDTSV(v,_,te,"hard");setDV(usdF.format(te),"price-hard"),setDPD(ee,"pc-hard");let De=L.find(t=>"hard"===t.denom).amount;const de=setDTS(De,1e6,te,"ts-hard");setDTS(De,1e6,te,"ts-m-hard"),setDV(usdF.format(P),"te-hard"),setDV(usdF.format(P),"te-m-hard"),setDAPY(te,qt,"hard-a",i,y,"ea-hard"),setDAPY(te,qt,"hard-a",i,y,"ea-m-hard"),setUABD("hard",Wt,Qt),setDV(formatMNDS(H+ct+Pt+Nt+Ht+de),"t-a-s"),setDV(formatMNDS(j+pt+W+kt+Yt+Wt),"t-a-b");const ce=p.market_data.current_price.usd,ne=p.market_data.price_change_percentage_24h;let{usdxUsd:oe,usdxMC:ue,usdxSupply:me}=await setDTSV(v,_,ce,"usdx");setDV(formatMNDS(O+st+Vt+Tt+It+se+oe),"t-m-c"),setDV(usdF.format(i),"price-d-kava"),setDPD(Ot,"pc-d-kava"),setDV(Kt,"mc-kava"),setDV(Zt,"s-kava"),setDV(usdF.format(i),"price-md-kava"),setDPD(Ot,"pc-md-kava"),setDV(Kt,"mc-m-kava"),setDV(Zt,"s-m-kava"),setDV(usdF.format(te),"price-d-hard"),setDPD(ee,"pc-d-hard"),setDV(ae,"mc-hard"),setDV(re,"s-hard"),setDV(usdF.format(te),"price-md-hard"),setDPD(ee,"pc-md-hard"),setDV(ae,"mc-m-hard"),setDV(re,"s-m-hard"),setDV(usdF.format(ce),"price-d-usdx"),setDPD(ne,"pc-d-usdx"),setDV(ue,"mc-usdx"),setDV(me,"s-usdx"),setDV(setUAL(C)+" "+denomLabel("usdx"),"al-usdx"),setDV(usdF.format(ce),"price-md-usdx"),setDPD(ne,"pc-md-usdx"),setDV(ue,"mc-m-usdx"),setDV(me,"s-m-usdx"),setDV(setUAL(C)+" "+denomLabel("usdx"),"al-m-usdx"),setDV(usdF.format(it),"price-d-btc"),setDPD(lt,"pc-d-btc"),setDV(ft,"mc-btc"),setDV(At,"s-btc"),setDV(ht,"al-btc"),setDV(usdF.format(it),"price-md-btc"),setDPD(lt,"pc-md-btc"),setDV(ft,"mc-m-btc"),setDV(At,"s-m-btc"),setDV(ht,"al-m-btc"),setDV(usdF.format(Lt),"price-d-xrp"),setDPD(vt,"pc-d-xrp"),setDV(_t,"mc-xrp"),setDV(Ct,"s-xrp"),setDV(yt,"al-xrp"),setDV(usdF.format(Lt),"price-md-xrp"),setDPD(vt,"pc-md-xrp"),setDV(_t,"mc-m-xrp"),setDV(Ct,"s-m-xrp"),setDV(yt,"al-m-xrp"),setDV(usdF.format(tt),"price-d-busd"),setDPD(et,"pc-d-busd"),setDV(at,"mc-busd"),setDV(rt,"s-busd"),setDV(Dt,"al-busd"),setDV(usdF.format(tt),"price-md-busd"),setDPD(et,"pc-md-busd"),setDV(at,"mc-m-busd"),setDV(rt,"s-m-busd"),setDV(Dt,"al-m-busd"),setDV(usdF.format($),"price-d-bnb"),setDPD(Y,"pc-d-bnb"),setDV(I,"mc-bnb"),setDV(K,"s-bnb"),setDV(Z,"al-bnb"),setDV(usdF.format($),"price-md-bnb"),setDPD(Y,"pc-md-bnb"),setDV(I,"mc-m-bnb"),setDV(K,"s-m-bnb"),setDV(Z,"al-m-bnb")},main=async()=>{await updateDV(),await sleep(6e4),main()},sleep=(t=1e4)=>new Promise(e=>setTimeout(e,t));main();

// kava6
// kava-protocol
function rewardPeriodsPerYear(e){return 314496e11/+e}const FACTOR_SIX=1e6,FACTOR_EIGHT=1e8,BASE_URL="https://api.kava.io";var usdFormatter=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),isKavaNativeAsset=e=>["ukava-a","usdx","hard","ukava","hard-a"].includes(e),totalLockedAndBorrowedByDenom=(e,t)=>{var{collateral:a,principal:o,accumulated_fees:r}=e.reduce(function(e,t){return Object.keys(t.cdp).forEach(function(a){["collateral","principal","accumulated_fees"].includes(a)&&(e[a]=+(e[a]||0)+ +t.cdp[a].amount)}),e},{});return{locked:isKavaNativeAsset(t)?+a/1e6:+a/1e8,borrowed:+o/1e6,fees:+r/1e6}},totalAmountOnPlatformByDenom=(e,t)=>{const a=e.result.find(e=>e.current_supply.denom===t);let o=0;return a&&(o=+a.current_supply.amount),o},getRewardApyForDenom=(e,t,a,o)=>{const r=o.result;let n=0,s=0;if(r&&r.rewards&&r.rewards.length>0){const t=o.result.rewards.find(t=>t.collateral_type.toUpperCase()===e.toUpperCase());n=+t.available_rewards.amount,s=+t.duration}const l=100*+(n/1e6*rewardPeriodsPerYear(s)*+a/t),d=usdFormatter.format(l);return d.slice(1,d.length)+"%"},usdxDebtLimitByDenom=(e,t)=>{const a=t.result.collateral_params.find(t=>t.type.toUpperCase()===e.toUpperCase());return a&&a.debt_limit?+a.debt_limit.amount/1e6:0},setUsdxAmount=(e,t,a,o)=>{if(e&&t){const t=a+o;return t>e?+e:+t}},setDenomTotalLocked=(e,t,a,o)=>{const r=+(e/t)*a/1e6,n=usdFormatter.format(r)+"M";document.getElementById(o).innerHTML=n},setDenomTotalBorrowed=(e,t)=>{const a=e/1e6,o=usdFormatter.format(a)+"M";document.getElementById(t).innerHTML=o},setDenomAPY=(e,t,a,o,r,n)=>{const s=getRewardApyForDenom(a,+e*+t,o,r);document.getElementById(n).innerHTML=s},setKavaChainDenomInfo=async(e,t,a,o,r,n,s,l,d,i,c)=>{"ukava"===a&&(o=l);let u=e.find(e=>e.denom===a).amount;u&&setDenomTotalLocked(u,1e6,o,r),n&&setDenomTotalBorrowed(n,s),o&&l&&d&&i&&t&&c&&i&&setDenomAPY(o,d,i,l,t,c)},setBep3DenomInfo=async(e,t,a,o,r,n,s,l,d,i,c,u)=>{let m=+totalAmountOnPlatformByDenom(t,r)/1e8*o,p=e.find(e=>e.denom===r).amount;return p&&setDenomTotalLocked(p,1e8,o,n),s&&setDenomTotalBorrowed(s,l),o&&d&&i&&c&&a&&u&&setDenomAPY(o,i,c,d,a,u),{denomTotalSupplyValue:m}},getValueRewardsDistributedForDenom=(e,t,a,o)=>{if(!o)return 0;let r=0;if(e.result){const a=e.result.find(e=>e.collateral_type.toUpperCase()===t.toUpperCase()),n=(Date.now()-o.getTime())/1e3;r=+a.reward.amount*+n/1e6}return+r*+a},getCollateralPrice=e=>{return+(e&&e.result).price},updateDisplayValues=async()=>{const[e,t,a,o,r,n,s,l,d,i,c,u,m,p,w,B,D,A,b]=await Promise.all([fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=KAVAUSDT"),fetch(BASE_URL+"/incentive/rewardperiods"),fetch(BASE_URL+"/auth/accounts/kava1wq9ts6l7atfn45ryxrtg4a2gwegsh3xha9e6rp"),fetch(BASE_URL+"/bep3/supplies"),fetch(BASE_URL+"/bep3/parameters"),fetch(BASE_URL+"/cdp/parameters"),fetch(BASE_URL+"/incentive/parameters"),fetch(BASE_URL+"/cdp/cdps/collateralType/btcb-a"),fetch(BASE_URL+"/cdp/cdps/collateralType/busd-a"),fetch(BASE_URL+"/cdp/cdps/collateralType/xrpb-a"),fetch(BASE_URL+"/cdp/cdps/collateralType/bnb-a"),fetch(BASE_URL+"/cdp/cdps/collateralType/ukava-a"),fetch(BASE_URL+"/cdp/cdps/collateralType/hard-a"),fetch(BASE_URL+"/pricefeed/price/btc:usd"),fetch(BASE_URL+"/pricefeed/price/busd:usd"),fetch(BASE_URL+"/pricefeed/price/xrp:usd"),fetch(BASE_URL+"/pricefeed/price/bnb:usd"),fetch(BASE_URL+"/pricefeed/price/kava:usd"),fetch(BASE_URL+"/pricefeed/price/hard:usd")]),f=await e.json(),T=await t.json(),y=await a.json(),L=await o.json(),h=(await r.json(),await n.json()),U=await s.json(),R=await l.json(),S=await d.json(),k=await i.json(),g=await c.json(),_=await u.json(),E=await m.json(),P=await p.json(),v=await w.json(),x=await B.json(),C=await D.json(),j=await A.json(),V=await b.json(),F=await f.lastPrice,I=getValueRewardsDistributedForDenom(T,"bnb-a",F,new Date("2020-07-29T14:00:14.333506701Z"))+getValueRewardsDistributedForDenom(T,"busd-a",F,new Date("2020-11-09T14:00:14.333506701Z"))+getValueRewardsDistributedForDenom(T,"btcb-a",F,new Date("2020-11-16T14:00:14.333506701Z"))+getValueRewardsDistributedForDenom(T,"xrpb-a",F,new Date("2020-12-02T14:00:14.333506701Z"))+getValueRewardsDistributedForDenom(T,"ukava-a",F,new Date("2020-12-14T14:00:14.333506701Z"))+getValueRewardsDistributedForDenom(T,"hard-a",F,new Date("2021-01-15T14:00:14.333506701Z")),K=usdFormatter.format(I),Y=K.slice(1,K.length);document.getElementById("TOTAL-REWARDS-DISTRIBUTED").innerHTML=Y;const H=await y.result.value.coins,O=await totalLockedAndBorrowedByDenom(R.result,"btcb-a"),M=await totalLockedAndBorrowedByDenom(S.result,"busd-a"),N=await totalLockedAndBorrowedByDenom(k.result,"xrpb-a"),Z=await totalLockedAndBorrowedByDenom(g.result,"bnb-a"),X=await totalLockedAndBorrowedByDenom(_.result,"ukava-a"),q=await totalLockedAndBorrowedByDenom(E.result,"hard-a"),G=getCollateralPrice(P),W=getCollateralPrice(v),z=getCollateralPrice(x),J=getCollateralPrice(C),Q=getCollateralPrice(j),ee=getCollateralPrice(V);let te,ae,oe;O&&(te=O.locked,ae=O.borrowed,oe=O.fees);let re,ne,se,le=await usdxDebtLimitByDenom("BTCB-A",h),de=setUsdxAmount(le,O,ae,oe),ie=(await setBep3DenomInfo(H,L,U,G,"btcb","TL-BTC",de,"TB-BTC",F,te,"btcb-a","APY-BTC")).denomTotalSupplyValue;M&&(re=M.locked,ne=M.borrowed,se=M.fees);let ce,ue,me,pe=await usdxDebtLimitByDenom("BUSD-A",h),we=setUsdxAmount(pe,M,ne,se),Be=(await setBep3DenomInfo(H,L,U,W,"busd","TL-BUSD",we,"TB-BUSD",F,re,"busd-a","APY-BUSD")).denomTotalSupplyValue;N&&(ce=N.locked,ue=N.borrowed,me=N.fees);let De,Ae,be,fe=await usdxDebtLimitByDenom("XRPB-A",h),Te=setUsdxAmount(fe,N,ue,me),ye=(await setBep3DenomInfo(H,L,U,z,"xrpb","TL-XRP",Te,"TB-XRP",F,ce,"xrpb-a","APY-XRP")).denomTotalSupplyValue;Z&&(De=Z.locked,Ae=Z.borrowed,be=Z.fees);let Le,he,Ue,Re=await usdxDebtLimitByDenom("BNB-A",h),Se=setUsdxAmount(Re,Z,Ae,be),ke=(await setBep3DenomInfo(H,L,U,J,"bnb","TL-BNB",Se,"TB-BNB",F,De,"bnb-a","APY-BNB")).denomTotalSupplyValue;X&&(Le=X.locked,he=X.borrowed,Ue=X.fees);let ge,_e,Ee,Pe=await usdxDebtLimitByDenom("UKAVA-A",h),ve=setUsdxAmount(Pe,X,he,Ue);await setKavaChainDenomInfo(H,U,"ukava",Q,"TL-KAVA",ve,"TB-KAVA",F,Le,"ukava-a","APY-KAVA"),q&&(ge=q.locked,_e=q.borrowed,Ee=q.fees);let xe=await usdxDebtLimitByDenom("HARD-A",h),Ce=setUsdxAmount(xe,q,_e,Ee);await setKavaChainDenomInfo(H,U,"hard",ee,"TL-HARD",Ce,"TB-HARD",F,ge,"hard-a","APY-HARD");let je=ke+ie+Be+ye+(Se+de+we+Te+ve+Ce);const Ve=usdFormatter.format(je),Fe=Ve.slice(1,Ve.length);document.getElementById("TOTAL-VALUE-LOCKED").innerHTML=Fe,$(".metric-blur").css("background-color","transparent"),$(".metric-blur").addClass("without-after"),$(".api-metric").css({display:"block","text-align":"center"})},main=async()=>{Promise.all(await updateDisplayValues(),await sleep(6e4),main())},sleep=(e=1e4)=>new Promise(t=>setTimeout(t,e));main();

// hard-protocol
function formatNumbers(e,a=2){return(+e).toFixed(a).toString().replace(/^([-+]?)(0?)(\d+)(.?)(\d+)$/g,function(e,a,t,n,r,s){var i=function(e){return e.split("").reverse().join("")},o=function(e){var a=i(e).match(/.{1,3}/g).join(",");return i(a)};return a+(r?o(n)+r+s:o(n+s))})}function rewardPeriodsPerYear(e){return 31536e3*+e/1e6}const FACTOR_SIX=1e6,FACTOR_EIGHT=1e8,BASE_URL="https://api.kava.io";var usdFormatter=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});const KAVA_DENOM="ukava",HARD_DENOM="hard",USDX_DENOM="usdx",BNB_DENOM="bnb",BTC_DENOM="btcb",XRP_DENOM="xrpb",BUSD_DENOM="busd";var getBalanceForDenom=(e,a)=>{const t=a.find(a=>a.denom===e);return t?+t.amount:0},formatPercentage=e=>e+"%",convertToCoin=e=>{const a=e.denom,t=+e.amount;let n;switch(a){case"bnb":case"btcb":case"xrpb":case"busd":n=t/1e8;break;default:n=t/1e6}return n},getModuleBalances=async e=>e.find(e=>"harvest"===e.value.name).value.coins,getRewardPerYearByDenom=async e=>{return e.liquidity_provider_schedules.map(e=>{const a=rewardPeriodsPerYear(e.rewards_per_second.amount);return{denom:e.deposit_denom,amount:a}})},setApyByDenom=(e,a,t)=>t.map(n=>{const r=a.find(e=>e.name===n.denom),s=e.find(e=>e.denom===n.denom),i=convertToCoin(s),o=t.find(e=>e.denom===n.denom),c=a.find(e=>"hard"===e.name).price,u=o.amount*c,l=i*r.price,d=(formatNumbers(u/l*100),formatPercentage(formatNumbers(u/l*100)));return{denom:n.denom,apy:d}}),getKavaPrice=async()=>{const e=await fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=KAVAUSDT"),a=await e.json();return{price:a.lastPrice,percentChange:a.priceChangePercent}},getValueRewardsDistributed=async e=>{const a=await fetch("https://api.kava.io/incentive/rewardperiods"),t=await a.json(),n=new Date("2020-07-29T14:00:14.333506701Z"),r=(Date.now()-n.getTime())/1e3;let s=0;if(t.result){s=+t.result.find(e=>"bnb-a"===e.collateral_type).reward.amount*+r/1e6}return+s*+e},getTotalValues=async(e,a)=>{var t=new Map;t.set("usdx",1e6),t.set("ukava",1e6),t.set("hard",1e6),t.set("bnb",1e8),t.set("btcb",1e8),t.set("xrpb",1e8),t.set("busd",1e8);var n=[];if(a&&a.length>0){const r="kava16zr7aqvk473073s6a5jgaxus6hx2vn5laum9s3",s=a.find(e=>e.value.address===r).value.coins;for(coin of s){const a=+coin.amount/t.get(coin.denom)*+e.find(e=>e.name===coin.denom).price;n.push({denom:coin.denom,total_value:a})}}return n},setTotalValue=async(e,a,t)=>{const n=t.find(a=>a.denom===e).total_value;return n&&(document.getElementById(a).innerHTML=usdFormatter.format(n)),n},setApyValue=(e,a,t)=>{const n=t.find(a=>a.denom===e);document.getElementById(a).innerHTML=n.apy},updateDisplayValues=async()=>{const[e,a,t,n,r,s,i]=await Promise.all([fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=HARDUSDT"),fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=KAVAUSDT"),fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=BNBUSDT"),fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=BTCUSDT"),fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=XRPUSDT"),fetch("https://api.kava.io/harvest/parameters"),fetch(`${BASE_URL}/harvest/accounts`)]),o=await e.json(),c=await a.json(),u=await t.json(),l=await n.json(),d=await r.json(),m=await s.json(),p=await i.json(),b=await m.result,w=await p.result,h=[{name:"hard",price:await o.lastPrice},{name:"ukava",price:await c.lastPrice},{name:"bnb",price:await u.lastPrice},{name:"btcb",price:await l.lastPrice},{name:"busd",price:1},{name:"xrpb",price:await d.lastPrice},{name:"usdx",price:1}],v=h.find(e=>"hard"===e.name).price,y=await getTotalHardAvailable(b),f=usdFormatter.format(y*v),T=f.slice(0,f.length);document.getElementById("total-hard-dist").innerHTML=T;const A=await getTotalValues(h,w),D=await setTotalValue("bnb","TL-BNB",A)+await setTotalValue("ukava","TL-KAVA",A)+await setTotalValue("usdx","TL-USDX",A)+await setTotalValue("hard","TL-HARD",A)+await setTotalValue("btcb","TL-BTC",A)+await setTotalValue("busd","TL-BUSD",A)+await setTotalValue("xrpb","TL-XRP",A);document.getElementById("TAV").innerHTML=usdFormatter.format(D);const g=await getModuleBalances(w),P=(getBalanceForDenom("bnb",g),await getRewardPerYearByDenom(b)),B=setApyByDenom(g,h,P);setApyValue("bnb","APY-BNB",B),setApyValue("hard","APY-HARD",B),setApyValue("ukava","APY-KAVA",B),setApyValue("usdx","APY-USDX",B),setApyValue("btcb","APY-BTC",B),setApyValue("xrpb","APY-XRP",B),setApyValue("busd","APY-BUSD",B),$(".metric-blur").css("background-color","transparent"),$(".metric-blur").addClass("without-after"),$(".api-metric").css({display:"block","text-align":"center"})},getTotalHardAvailable=async e=>{let a=0;if(e)for(lps of e.liquidity_provider_schedules){const e=Date.parse(lps.start);a+=(Date.now()-e)/1e3*+lps.rewards_per_second.amount}return a/1e6},main=async()=>{await updateDisplayValues(),await sleep(6e4),main()},sleep=(e=1e4)=>new Promise(a=>setTimeout(a,e));main(),setTimeout(async function(){const e=await getKavaPrice();await getValueRewardsDistributed(+e.price)},2e3);

// kava stats
function rPPY(t){return 314496e11/+t}const FACTOR_SIX=1e6,FACTOR_EIGHT=1e8,BASE_URL="https://api.kava.io",BINANACE_URL="https://api.binance.com/api/v3";var usdF=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),formatMM=t=>{const e=t/1e6;return usdF.format(e)+"M"},formatMNDOL=t=>{const e=usdF.format(t);return e.slice(1,e.length-3)},formatMNDS=t=>{const e=usdF.format(t);return e.slice(1,e.length)},isKNA=t=>["ukava-a","usdx","hard","ukava","hard-a"].includes(t),denomLabel=t=>{switch(t){case"xrpb":return"XRP";case"ukava":return"KAVA";case"btcb":return"BTC";default:return t.toUpperCase()}},tLABBD=async t=>{let e=BASE_URL+`/cdp/cdps/collateralType/${t}`,s=await fetch(e),a=await s.json(),r=a&&a.result;var{collateral:D,principal:d,accumulated_fees:c}=r.reduce(function(t,e){return Object.keys(e.cdp).forEach(function(s){["collateral","principal","accumulated_fees"].includes(s)&&(t[s]=+(t[s]||0)+ +e.cdp[s].amount)}),t},{});return{locked:isKNA(t)?+D/1e6:+D/1e8,borrowed:+d/1e6,fees:+c/1e6}},bAOP=t=>{return+t.result.find(t=>"bnb"===t.current_supply.denom).current_supply.amount},tAOPBD=(t,e)=>{return+t.result.find(t=>t.denom===e).amount},getRAFD=(t,e,s,a)=>{const r=a.result;let D=0,d=0;if(r&&r.rewards&&r.rewards.length>0){const e=a.result.rewards.find(e=>e.collateral_type.toUpperCase()===t.toUpperCase());D=+e.available_rewards.amount,d=+e.duration}const c=100*+(D/1e6*rPPY(d)*+s/e),n=usdF.format(c);return n.slice(1,n.length)+"%"},uDLBD=(t,e)=>{const s=e.result.collateral_params.find(e=>e.type.toUpperCase()===t.toUpperCase());return s&&s.debt_limit?+s.debt_limit.amount/1e6:0},setUA=(t,e,s)=>{if(t&&e){const a=e+s;return a>t?+t:+a}},supplyLBD=(t,e)=>{const s=e.result.asset_params.find(e=>e.denom.toUpperCase()===t.toUpperCase());return s&&s.supply_limit&&s.supply_limit.limit?+s.supply_limit.limit/1e8:0},setDTS=(t,e,s,a)=>{const r=+(t/e)*s;return setDV(formatMNDS(r),a),r},setDAPY=(t,e,s,a,r,D)=>{const d=getRAFD(s,+t*+e,a,r);setDV(d,D)},setDTSV=async(t,e,s,a)=>{let r,D;r="bnb"===a?bAOP(t):tAOPBD(t,a);let d=+(D=isKNA(a)?+r/1e6:+r/1e8)*s,c=supplyLBD(a,e),n={};return n[`${a}Usd`]=d,n[`${a}MC`]=formatMM(d),n[`${a}Supply`]=formatMNDOL(D)+" "+denomLabel(a),n[`${a}AL`]=formatMNDOL(c)+" "+denomLabel(a),n},getRPD=async()=>{const t=await fetch("https://api.kava.io/incentive/rewardperiods");return await t.json()},getVRDFD=(t,e,s,a)=>{if(!a)return 0;let r=0;if(t.result){const s=t.result.find(t=>t.collateral_type.toUpperCase()===e.toUpperCase()),D=(Date.now()-a.getTime())/1e3;r=+s.reward.amount*+D/1e6}return+r*+s},setUABD=(t,e,s)=>{const a=formatMNDOL(e),r=formatMNDOL(s),D=(100*(+e.toFixed(0)/+s.toFixed(0)).toFixed(3)).toFixed(2)+"%";$(`.percent-line-usdx-${t}`).css("width",D),setDV(a,`tb-${t}`),setDV(r,`bl-${t}`)},setDPD=(t,e)=>{let s;0>+t?(s=usdF.format(t).replace("$","")+"%",setDC("red",e)):(s="+"+formatMNDS(t)+"%",setDC("green",e)),setDV(s,e)},setUAL=t=>formatMNDOL(+t.result.global_debt_limit.amount/1e6),setDV=(t,e)=>{$(`#${e}`).last().html(t),$(`#${e}`).first().html(t)},setDC=(t,e)=>{$(`#${e}`).css({color:t})},updateDV=async()=>{const[t,e,s,a,r,D,d]=await Promise.all([fetch(BINANACE_URL+"/ticker/24hr?symbol=KAVAUSDT"),fetch(BINANACE_URL+"/ticker/24hr?symbol=HARDUSDT"),fetch(BINANACE_URL+"/ticker/24hr?symbol=BNBUSDT"),fetch(BINANACE_URL+"/ticker/24hr?symbol=BUSDUSDT"),fetch(BINANACE_URL+"/ticker/24hr?symbol=BTCUSDT"),fetch(BINANACE_URL+"/ticker/24hr?symbol=XRPUSDT"),fetch("https://api.coingecko.com/api/v3/coins/usdx")]),c=await t.json(),n=await e.json(),o=await s.json(),u=await a.json(),m=await r.json(),b=await D.json(),p=await d.json(),i=+c.lastPrice,l=await getRPD(),V=getVRDFD(l,"bnb-a",i,new Date("2020-07-29T14:00:14.333506701Z")),f=getVRDFD(l,"busd-a",i,new Date("2020-11-09T14:00:14.333506701Z")),A=getVRDFD(l,"btcb-a",i,new Date("2020-11-16T14:00:14.333506701Z")),h=getVRDFD(l,"xrpb-a",i,new Date("2020-12-02T14:00:14.333506701Z")),w=getVRDFD(l,"ukava-a",i,new Date("2020-12-14T14:00:14.333506701Z")),P=getVRDFD(l,"hard-a",i,new Date("2020-12-28T14:00:14.333506701Z")),[U,B,x,F,S,k]=await Promise.all([fetch(BASE_URL+"/auth/accounts/kava1wq9ts6l7atfn45ryxrtg4a2gwegsh3xha9e6rp"),fetch(BASE_URL+"/supply/total"),fetch(BASE_URL+"/bep3/supplies"),fetch(BASE_URL+"/bep3/parameters"),fetch(BASE_URL+"/cdp/parameters"),fetch(BASE_URL+"/incentive/parameters")]),L=(await U.json()).result.value.coins,v=await B.json(),T=await x.json(),_=await F.json(),C=await S.json(),y=await k.json();let R,N,g,M=await tLABBD("bnb-a");M&&(R=M.locked,N=M.borrowed,g=M.fees);let E=await uDLBD("BNB-A",C),j=setUA(E,N,g),$=+o.lastPrice;const Y=+o.priceChangePercent;let{bnbUsd:O,bnbMC:I,bnbSupply:K,bnbAL:Z}=await setDTSV(T,_,$,"bnb");setDV(usdF.format($),"price-bnb"),setDPD(Y,"pc-bnb");let X=L.find(t=>"bnb"===t.denom).amount;const H=setDTS(X,1e8,$,"ts-bnb");setDTS(X,1e8,$,"ts-m-bnb"),setDV(usdF.format(V),"te-bnb"),setDV(usdF.format(V),"te-m-bnb"),setDAPY($,R,"bnb-a",i,y,"ea-bnb"),setDAPY($,R,"bnb-a",i,y,"ea-m-bnb"),setUABD("bnb",j,E);let q,G,z,J=await tLABBD("busd-a");J&&(q=J.locked,G=J.borrowed,z=J.fees);let Q=await uDLBD("BUSD-A",C),W=setUA(Q,G,z),tt=+u.lastPrice;const et=+u.priceChangePercent;let{busdUsd:st,busdMC:at,busdSupply:rt,busdAL:Dt}=await setDTSV(v,_,tt,"busd");setDV(usdF.format(tt),"price-busd"),setDPD(et,"pc-busd");let dt=L.find(t=>"busd"===t.denom).amount;const ct=setDTS(dt,1e8,tt,"ts-busd");setDTS(dt,1e8,tt,"ts-m-busd"),setDV(usdF.format(f),"te-busd"),setDV(usdF.format(f),"te-m-busd"),setDAPY(tt,q,"busd-a",i,y,"ea-busd"),setDAPY(tt,q,"busd-a",i,y,"ea-m-busd"),setUABD("busd",W,Q);let nt,ot,ut,mt=await tLABBD("btcb-a");mt&&(nt=mt.locked,ot=mt.borrowed,ut=mt.fees);let bt=await uDLBD("BTCB-A",C),pt=setUA(bt,ot,ut),it=+m.lastPrice;const lt=+m.priceChangePercent;let{btcbUsd:Vt,btcbMC:ft,btcbSupply:At,btcbAL:ht}=await setDTSV(v,_,it,"btcb");setDV(usdF.format(it),"price-btc"),setDPD(lt,"pc-btc");let wt=L.find(t=>"btcb"===t.denom).amount;const Pt=setDTS(wt,1e8,it,"ts-btc");setDTS(wt,1e8,it,"ts-m-btc"),setDV(usdF.format(A),"te-btc"),setDV(usdF.format(A),"te-m-btc"),setDAPY(it,nt,"btcb-a",i,y,"ea-btc"),setDAPY(it,nt,"btcb-a",i,y,"ea-m-btc"),setUABD("btc",pt,bt);let Ut,Bt,xt,Ft=await tLABBD("xrpb-a");Ft&&(Ut=Ft.locked,Bt=Ft.borrowed,xt=Ft.fees);let St=await uDLBD("XRPB-A",C),kt=setUA(St,Bt,xt),Lt=+b.lastPrice;const vt=+b.priceChangePercent;let{xrpbUsd:Tt,xrpbMC:_t,xrpbSupply:Ct,xrpbAL:yt}=await setDTSV(v,_,Lt,"xrpb");setDV(usdF.format(Lt),"price-xrp"),setDPD(vt,"pc-xrp");let Rt=L.find(t=>"xrpb"===t.denom).amount;const Nt=setDTS(Rt,1e8,Lt,"ts-xrp");setDTS(Rt,1e8,Lt,"ts-m-xrp"),setDV(usdF.format(h),"te-xrpb"),setDV(usdF.format(h),"te-m-xrpb"),setDAPY(Lt,Ut,"xrpb-a",i,y,"ea-xrp"),setDAPY(Lt,Ut,"xrpb-a",i,y,"ea-m-xrp"),setUABD("xrp",kt,St);let gt,Mt,Et,jt=await tLABBD("ukava-a");jt&&(gt=jt.locked,Mt=jt.borrowed,Et=jt.fees);let $t=await uDLBD("UKAVA-A",C),Yt=setUA($t,Mt,Et);const Ot=+c.priceChangePercent;let{ukavaUsd:It,ukavaMC:Kt,ukavaSupply:Zt}=await setDTSV(v,_,i,"ukava");setDV(usdF.format(i),"price-kava"),setDPD(Ot,"pc-kava");let Xt=L.find(t=>"ukava"===t.denom).amount;const Ht=setDTS(Xt,1e6,i,"ts-kava");setDTS(Xt,1e6,i,"ts-m-kava"),setDV(usdF.format(w),"te-kava"),setDV(usdF.format(w),"te-m-kava"),setDAPY(i,gt,"ukava-a",i,y,"ea-kava"),setDAPY(i,gt,"ukava-a",i,y,"ea-m-kava"),setUABD("kava",Yt,$t);let qt,Gt,zt,Jt=await tLABBD("hard-a");Jt&&(qt=Jt.locked,Gt=Jt.borrowed,zt=Jt.fees);let Qt=await uDLBD("HARD-A",C),Wt=setUA(Qt,Gt,zt),te=+n.lastPrice;const ee=+n.priceChangePercent;let{hardUsd:se,hardMC:ae,hardSupply:re}=await setDTSV(v,_,te,"hard");setDV(usdF.format(te),"price-hard"),setDPD(ee,"pc-hard");let De=L.find(t=>"hard"===t.denom).amount;const de=setDTS(De,1e6,te,"ts-hard");setDTS(De,1e6,te,"ts-m-hard"),setDV(usdF.format(P),"te-hard"),setDV(usdF.format(P),"te-m-hard"),setDAPY(te,qt,"hard-a",i,y,"ea-hard"),setDAPY(te,qt,"hard-a",i,y,"ea-m-hard"),setUABD("hard",Wt,Qt),setDV(formatMNDS(H+ct+Pt+Nt+Ht+de),"t-a-s"),setDV(formatMNDS(j+pt+W+kt+Yt+Wt),"t-a-b");const ce=p.market_data.current_price.usd,ne=p.market_data.price_change_percentage_24h;let{usdxUsd:oe,usdxMC:ue,usdxSupply:me}=await setDTSV(v,_,ce,"usdx");setDV(formatMNDS(O+st+Vt+Tt+It+se+oe),"t-m-c"),setDV(usdF.format(i),"price-d-kava"),setDPD(Ot,"pc-d-kava"),setDV(Kt,"mc-kava"),setDV(Zt,"s-kava"),setDV(usdF.format(i),"price-md-kava"),setDPD(Ot,"pc-md-kava"),setDV(Kt,"mc-m-kava"),setDV(Zt,"s-m-kava"),setDV(usdF.format(te),"price-d-hard"),setDPD(ee,"pc-d-hard"),setDV(ae,"mc-hard"),setDV(re,"s-hard"),setDV(usdF.format(te),"price-md-hard"),setDPD(ee,"pc-md-hard"),setDV(ae,"mc-m-hard"),setDV(re,"s-m-hard"),setDV(usdF.format(ce),"price-d-usdx"),setDPD(ne,"pc-d-usdx"),setDV(ue,"mc-usdx"),setDV(me,"s-usdx"),setDV(setUAL(C)+" "+denomLabel("usdx"),"al-usdx"),setDV(usdF.format(ce),"price-md-usdx"),setDPD(ne,"pc-md-usdx"),setDV(ue,"mc-m-usdx"),setDV(me,"s-m-usdx"),setDV(setUAL(C)+" "+denomLabel("usdx"),"al-m-usdx"),setDV(usdF.format(it),"price-d-btc"),setDPD(lt,"pc-d-btc"),setDV(ft,"mc-btc"),setDV(At,"s-btc"),setDV(ht,"al-btc"),setDV(usdF.format(it),"price-md-btc"),setDPD(lt,"pc-md-btc"),setDV(ft,"mc-m-btc"),setDV(At,"s-m-btc"),setDV(ht,"al-m-btc"),setDV(usdF.format(Lt),"price-d-xrp"),setDPD(vt,"pc-d-xrp"),setDV(_t,"mc-xrp"),setDV(Ct,"s-xrp"),setDV(yt,"al-xrp"),setDV(usdF.format(Lt),"price-md-xrp"),setDPD(vt,"pc-md-xrp"),setDV(_t,"mc-m-xrp"),setDV(Ct,"s-m-xrp"),setDV(yt,"al-m-xrp"),setDV(usdF.format(tt),"price-d-busd"),setDPD(et,"pc-d-busd"),setDV(at,"mc-busd"),setDV(rt,"s-busd"),setDV(Dt,"al-busd"),setDV(usdF.format(tt),"price-md-busd"),setDPD(et,"pc-md-busd"),setDV(at,"mc-m-busd"),setDV(rt,"s-m-busd"),setDV(Dt,"al-m-busd"),setDV(usdF.format($),"price-d-bnb"),setDPD(Y,"pc-d-bnb"),setDV(I,"mc-bnb"),setDV(K,"s-bnb"),setDV(Z,"al-bnb"),setDV(usdF.format($),"price-md-bnb"),setDPD(Y,"pc-md-bnb"),setDV(I,"mc-m-bnb"),setDV(K,"s-m-bnb"),setDV(Z,"al-m-bnb")},main=async()=>{await updateDV(),await sleep(6e4),main()},sleep=(t=1e4)=>new Promise(e=>setTimeout(e,t));main();


//kava7
// kava-protocol
function rewardPeriodsPerYear(e){return 314496e11/+e}const FACTOR_SIX=1e6,FACTOR_EIGHT=1e8,BASE_URL="https://api.kava.io";var usdFormatter=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),isKavaNativeAsset=e=>["ukava-a","usdx","hard","ukava","hard-a"].includes(e),totalLockedAndBorrowedByDenom=(e,t)=>{let a=0,o=0,r=0;if(e){var{collateral:n,principal:s,accumulated_fees:d}=e.reduce(function(e,t){return Object.keys(t.cdp).forEach(function(a){["collateral","principal","accumulated_fees"].includes(a)&&(e[a]=+(e[a]||0)+ +t.cdp[a].amount)}),e},{});a=isKavaNativeAsset(t)?+n/1e6:+n/1e8,o=+s/1e6,r=+d/1e6}return{locked:a,borrowed:o,fees:r}},totalAmountOnPlatformByDenom=(e,t)=>{const a=e.result.find(e=>e.current_supply.denom===t);let o=0;return a&&(o=+a.current_supply.amount),o},getRewardApyForDenom=(e,t,a,o)=>{const r=o.result;let n=0;if(r&&r.usdx_minting_reward_periods&&r.usdx_minting_reward_periods.length>0){n=+r.usdx_minting_reward_periods.find(t=>t.collateral_type.toUpperCase()===e.toUpperCase()).rewards_per_second.amount}const s=100*+(31536e3*n/1e6*+a/t),d=usdFormatter.format(s);return d.slice(1,d.length)+"%"},usdxDebtLimitByDenom=(e,t)=>{const a=t.result.collateral_params.find(t=>t.type.toUpperCase()===e.toUpperCase());return a&&a.debt_limit?+a.debt_limit.amount/1e6:0},setUsdxAmount=(e,t,a,o)=>{if(e&&t){const t=a+o;return t>e?+e:+t}},setDenomTotalLocked=(e,t,a,o)=>{const r=+(e/t)*a/1e6,n=usdFormatter.format(r)+"M";document.getElementById(o).innerHTML=n},setDenomTotalBorrowed=(e,t)=>{const a=e/1e6,o=usdFormatter.format(a)+"M";document.getElementById(t).innerHTML=o},setDenomAPY=(e,t,a,o,r,n)=>{const s=getRewardApyForDenom(a,+e*+t,o,r);document.getElementById(n).innerHTML=s},setKavaChainDenomInfo=async(e,t,a,o,r,n,s,d,l,i,c)=>{"ukava"===a&&(o=d);let u=e.find(e=>e.denom===a).amount;u&&setDenomTotalLocked(u,1e6,o,r),n&&setDenomTotalBorrowed(n,s),o&&d&&l&&i&&t&&c&&i&&setDenomAPY(o,l,i,d,t,c)},setBep3DenomInfo=async(e,t,a,o,r,n,s,d,l,i,c,u)=>{let m=+totalAmountOnPlatformByDenom(t,r)/1e8*o,p=0,w=e.find(e=>e.denom===r);return w&&(p=w.amount,setDenomTotalLocked(p,1e8,o,n)),s&&setDenomTotalBorrowed(s,d),o&&l&&i&&c&&a&&u&&setDenomAPY(o,i,c,l,a,u),{denomTotalSupplyValue:m}},getValueRewardsDistributedForDenom=(e,t,a,o)=>{if(!o)return 0;let r=0;if(e.result){const a=e.result.usdx_minting_reward_periods.find(e=>e.collateral_type.toUpperCase()===t.toUpperCase()),n=(Date.now()-o.getTime())/1e3;let s=0;a&&(s=a.rewards_per_second.amount),r=+s*+n/1e6}return+r*+a},getCollateralPrice=e=>{return+(e&&e.result).price},updateDisplayValues=async()=>{const[e,t,a,o,r,n,s,d,l,i,c,u,m,p,w,B,D,A,b]=await Promise.all([fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=KAVAUSDT"),fetch(BASE_URL+"/incentive/parameters"),fetch(BASE_URL+"/auth/accounts/kava1wq9ts6l7atfn45ryxrtg4a2gwegsh3xha9e6rp"),fetch(BASE_URL+"/bep3/supplies"),fetch(BASE_URL+"/bep3/parameters"),fetch(BASE_URL+"/cdp/parameters"),fetch(BASE_URL+"/incentive/parameters"),fetch(BASE_URL+"/cdp/cdps/collateralType/btcb-a"),fetch(BASE_URL+"/cdp/cdps/collateralType/busd-a"),fetch(BASE_URL+"/cdp/cdps/collateralType/xrpb-a"),fetch(BASE_URL+"/cdp/cdps/collateralType/bnb-a"),fetch(BASE_URL+"/cdp/cdps/collateralType/ukava-a"),fetch(BASE_URL+"/cdp/cdps/collateralType/hard-a"),fetch(BASE_URL+"/pricefeed/price/btc:usd"),fetch(BASE_URL+"/pricefeed/price/busd:usd"),fetch(BASE_URL+"/pricefeed/price/xrp:usd"),fetch(BASE_URL+"/pricefeed/price/bnb:usd"),fetch(BASE_URL+"/pricefeed/price/kava:usd"),fetch(BASE_URL+"/pricefeed/price/hard:usd")]),f=await e.json(),T=await t.json(),y=await a.json(),L=await o.json(),_=(await r.json(),await n.json()),h=await s.json(),U=await d.json(),R=await l.json(),g=await i.json(),S=await c.json(),k=await u.json(),E=await m.json(),x=await p.json(),P=await w.json(),v=await B.json(),C=await D.json(),j=await A.json(),V=await b.json(),F=await f.lastPrice,I=getValueRewardsDistributedForDenom(T,"bnb-a",F,new Date("2020-07-29T14:00:14.333506701Z"))+getValueRewardsDistributedForDenom(T,"busd-a",F,new Date("2020-11-09T14:00:14.333506701Z"))+getValueRewardsDistributedForDenom(T,"btcb-a",F,new Date("2020-11-16T14:00:14.333506701Z"))+getValueRewardsDistributedForDenom(T,"xrpb-a",F,new Date("2020-12-02T14:00:14.333506701Z"))+getValueRewardsDistributedForDenom(T,"ukava-a",F,new Date("2020-12-14T14:00:14.333506701Z"))+getValueRewardsDistributedForDenom(T,"hard-a",F,new Date("2021-01-15T14:00:14.333506701Z")),K=usdFormatter.format(I),H=K.slice(1,K.length);document.getElementById("TOTAL-REWARDS-DISTRIBUTED").innerHTML=H;const Y=await y.result.value.coins,O=totalLockedAndBorrowedByDenom(U.result,"btcb-a"),M=totalLockedAndBorrowedByDenom(R.result,"busd-a"),N=totalLockedAndBorrowedByDenom(g.result,"xrpb-a"),Z=totalLockedAndBorrowedByDenom(S.result,"bnb-a"),X=totalLockedAndBorrowedByDenom(k.result,"ukava-a"),q=totalLockedAndBorrowedByDenom(E.result,"hard-a"),G=getCollateralPrice(x),W=getCollateralPrice(P),z=getCollateralPrice(v),J=getCollateralPrice(C),Q=getCollateralPrice(j),ee=getCollateralPrice(V);let te,ae,oe;O&&(te=O.locked,ae=O.borrowed,oe=O.fees);let re,ne,se,de=await usdxDebtLimitByDenom("BTCB-A",_),le=setUsdxAmount(de,O,ae,oe),ie=(await setBep3DenomInfo(Y,L,h,G,"btcb","TL-BTC",le,"TB-BTC",F,te,"btcb-a","APY-BTC")).denomTotalSupplyValue;M&&(re=M.locked,ne=M.borrowed,se=M.fees);let ce,ue,me,pe=await usdxDebtLimitByDenom("BUSD-A",_),we=setUsdxAmount(pe,M,ne,se),Be=(await setBep3DenomInfo(Y,L,h,W,"busd","TL-BUSD",we,"TB-BUSD",F,re,"busd-a","APY-BUSD")).denomTotalSupplyValue;N&&(ce=N.locked,ue=N.borrowed,me=N.fees);let De,Ae,be,fe=await usdxDebtLimitByDenom("XRPB-A",_),Te=setUsdxAmount(fe,N,ue,me),ye=(await setBep3DenomInfo(Y,L,h,z,"xrpb","TL-XRP",Te,"TB-XRP",F,ce,"xrpb-a","APY-XRP")).denomTotalSupplyValue;Z&&(De=Z.locked,Ae=Z.borrowed,be=Z.fees);let Le,_e,he,Ue=await usdxDebtLimitByDenom("BNB-A",_),Re=setUsdxAmount(Ue,Z,Ae,be),ge=(await setBep3DenomInfo(Y,L,h,J,"bnb","TL-BNB",Re,"TB-BNB",F,De,"bnb-a","APY-BNB")).denomTotalSupplyValue;X&&(Le=X.locked,_e=X.borrowed,he=X.fees);let Se,ke,Ee,xe=await usdxDebtLimitByDenom("UKAVA-A",_),Pe=setUsdxAmount(xe,X,_e,he);await setKavaChainDenomInfo(Y,h,"ukava",Q,"TL-KAVA",Pe,"TB-KAVA",F,Le,"ukava-a","APY-KAVA"),q&&(Se=q.locked,ke=q.borrowed,Ee=q.fees);let ve=await usdxDebtLimitByDenom("HARD-A",_),Ce=setUsdxAmount(ve,q,ke,Ee);await setKavaChainDenomInfo(Y,h,"hard",ee,"TL-HARD",Ce,"TB-HARD",F,Se,"hard-a","APY-HARD");let je=ge+ie+Be+ye+(Re+le+we+Te+Pe+Ce);const Ve=usdFormatter.format(je),Fe=Ve.slice(1,Ve.length);document.getElementById("TOTAL-VALUE-LOCKED").innerHTML=Fe,$(".metric-blur").css("background-color","transparent"),$(".metric-blur").addClass("without-after"),$(".api-metric").css({display:"block","text-align":"center"})},main=async()=>{Promise.all(await updateDisplayValues(),await sleep(6e4),main())},sleep=(e=1e4)=>new Promise(t=>setTimeout(t,e));main();

// hard-protocol
function formatNumbers(e,a=2){return(+e).toFixed(a).toString().replace(/^([-+]?)(0?)(\d+)(.?)(\d+)$/g,function(e,a,t,r,n,o){var s=function(e){return e.split("").reverse().join("")},i=function(e){var a=s(e).match(/.{1,3}/g).join(",");return s(a)};return a+(n?i(r)+n+o:i(r+o))})}function rewardPeriodsPerYear(e){return 31536e3*+e/1e6}const FACTOR_SIX=1e6,FACTOR_EIGHT=1e8,BASE_URL="https://api.kava.io";var usdFormatter=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});const KAVA_DENOM="ukava",HARD_DENOM="hard",USDX_DENOM="usdx",BNB_DENOM="bnb",BTC_DENOM="btcb",XRP_DENOM="xrpb",BUSD_DENOM="busd";var getBalanceForDenom=(e,a)=>{const t=a.find(a=>a.denom===e);return t?+t.amount:0},formatPercentage=e=>e+"%",convertToCoin=e=>{const a=e.denom,t=+e.amount;let r;switch(a){case"bnb":case"btcb":case"xrpb":case"busd":r=t/1e8;break;default:r=t/1e6}return r},getModuleBalances=async e=>e.find(e=>"hard"===e.value.name).value.coins,getRewardPerYearByDenom=async e=>{return e.map(e=>{let a=0;const t=e.rewards_per_second.find(e=>"hard"===e.denom);t&&(a=t.amount);const r=rewardPeriodsPerYear(a);return{denom:e.collateral_type,amount:r}})},setApyByDenom=(e,a,t)=>t.map(r=>{const n=a.find(e=>e.name===r.denom),o=e.find(e=>e.denom===r.denom),s=convertToCoin(o),i=t.find(e=>e.denom===r.denom),c=a.find(e=>"hard"===e.name).price,l=i.amount*c,d=s*n.price,u=(formatNumbers(l/d*100),formatPercentage(formatNumbers(l/d*100)));return{denom:r.denom,apy:u}}),getKavaPrice=async()=>{const e=await fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=KAVAUSDT"),a=await e.json();return{price:a.lastPrice,percentChange:a.priceChangePercent}},getTotalValues=async(e,a)=>{var t=new Map;t.set("usdx",1e6),t.set("ukava",1e6),t.set("hard",1e6),t.set("bnb",1e8),t.set("btcb",1e8),t.set("xrpb",1e8),t.set("busd",1e8);var r=[];if(a&&a.length>0)for(coin of a){const a=+coin.amount/t.get(coin.denom)*+e.find(e=>e.name===coin.denom).price;r.push({denom:coin.denom,totalValue:a})}return r},setTotalValue=async(e,a,t)=>{let r=0;const n=t.find(a=>a.denom===e);return n&&(r=n.totalValue),document.getElementById(a).innerHTML=usdFormatter.format(r),r},setApyValue=(e,a,t)=>{const r=t.find(a=>a.denom===e);document.getElementById(a).innerHTML=r.apy},updateDisplayValues=async()=>{const[e,a,t,r,n,o,s,i,c]=await Promise.all([fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=HARDUSDT"),fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=KAVAUSDT"),fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=BNBUSDT"),fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=BTCUSDT"),fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=XRPUSDT"),fetch(`${BASE_URL}/hard/accounts`),fetch(`${BASE_URL}/hard/total-deposited`),fetch(`${BASE_URL}/hard/total-borrowed`),fetch(`${BASE_URL}/incentive/parameters`)]),l=await e.json(),d=await a.json(),u=await t.json(),m=await r.json(),p=await n.json(),b=await o.json(),w=await s.json(),h=await i.json(),T=await c.json(),f=await b.result,y=await w.result,A=await h.result,D=await T.result,B=[{name:"hard",price:await l.lastPrice},{name:"ukava",price:await d.lastPrice},{name:"bnb",price:await u.lastPrice},{name:"btcb",price:await m.lastPrice},{name:"busd",price:1},{name:"xrpb",price:await p.lastPrice},{name:"usdx",price:1}],V=B.find(e=>"hard"===e.name).price,g=await getTotalHardAvailable(D.hard_supply_reward_periods)+await getTotalHardAvailable(D.hard_borrow_reward_periods),P=usdFormatter.format(g*V),v=P.slice(0,P.length);document.getElementById("total-hard-dist").innerHTML=v;const _=await getTotalValues(B,y),S=(await setTotalValue("bnb","TL-BNB",_),await setTotalValue("ukava","TL-KAVA",_),await setTotalValue("usdx","TL-USDX",_),await setTotalValue("hard","TL-HARD",_),await setTotalValue("btcb","TL-BTC",_),await setTotalValue("busd","TL-BUSD",_),await setTotalValue("xrpb","TL-XRP",_),await getTotalValues(B,A)),U=(await setTotalValue("busd","TB-BUSD",S),await getModuleBalances(f)),E=(await getTotalValues(B,U)).reduce((e,a)=>e+a.totalValue,0);document.getElementById("TAV").innerHTML=usdFormatter.format(E);getBalanceForDenom("bnb",U);const R=await getRewardPerYearByDenom(D.hard_supply_reward_periods),L=setApyByDenom(U,B,R);setApyValue("bnb","APY-BNB",L),setApyValue("hard","APY-HARD",L),setApyValue("ukava","APY-KAVA",L),setApyValue("usdx","APY-USDX",L),setApyValue("btcb","APY-BTC",L),setApyValue("xrpb","APY-XRP",L),setApyValue("busd","APY-BUSD",L),$(".metric-blur").css("background-color","transparent"),$(".metric-blur").addClass("without-after"),$(".api-metric").css({display:"block","text-align":"center"})},getTotalHardAvailable=async e=>{let a=0;if(e)for(rp of e){const e=Date.parse(rp.start),t=(Date.now()-e)/1e3,r=rp.rewards_per_second.find(e=>"hard"===e.denom);let n=0;r&&(n=t*+r.amount),a+=n}return a/1e6},main=async()=>{await updateDisplayValues(),await sleep(6e4),main()},sleep=(e=1e4)=>new Promise(a=>setTimeout(a,e));main();

// kava stats
const TO_6=1e6,TO_8=1e8,BASE_URL="https://api.kava.io/",BINANACE_URL="https://api.binance.com/api/v3/";var usdF=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),formatMM=s=>{const t=s/1e6;return usdF.format(t)+"M"},fMNDOL=s=>{const t=usdF.format(s);return t.slice(1,t.length-3)},formatMNDS=s=>{const t=usdF.format(s);return t.slice(1,t.length)},isKNA=s=>["ukava-a","usdx","hard","ukava","hard-a"].includes(s),dLab=s=>{switch(s){case"xrpb":return"XRP";case"ukava":return"KAVA";case"btcb":return"BTC";default:return s.toUpperCase()}},tLABBD=async(s,t)=>{let a=0,e=0,r=0;if(s){var{collateral:c,principal:D,accumulated_fees:d}=s.reduce(function(s,t){return Object.keys(t.cdp).forEach(function(a){["collateral","principal","accumulated_fees"].includes(a)&&(s[a]=+(s[a]||0)+ +t.cdp[a].amount)}),s},{});a=isKNA(t)?+c/1e6:+c/1e8,e=+D/1e6,r=+d/1e6}return{locked:a,borrowed:e,fees:r}},bAOP=s=>{return+s.result.find(s=>"bnb"===s.current_supply.denom).current_supply.amount},tAOPBD=(s,t)=>{return+s.result.find(s=>s.denom===t).amount},getRAFD=(s,t,a,e)=>{const r=e.result.usdx_minting_reward_periods;let c=0;if(r&&r&&r.length>0){const t=r.find(t=>t.collateral_type.toUpperCase()===s.toUpperCase());t&&(c=+t.rewards_per_second.amount)}let D=0;0!==t&&(D=31536e3*c/1e6*+a/t);const d=100*+D,u=usdF.format(d);return u.slice(1,u.length)+"%"},uDLBD=(s,t)=>{const a=t.result.collateral_params.find(t=>t.type.toUpperCase()===s.toUpperCase());return a&&a.debt_limit?+a.debt_limit.amount/1e6:0},sUA=(s,t,a)=>{if(s&&void 0!==t){const e=t+a;return e>s?+s:+e}},supplyLBD=(s,t)=>{const a=t.result.asset_params.find(t=>t.denom.toUpperCase()===s.toUpperCase());return a&&a.supply_limit&&a.supply_limit.limit?+a.supply_limit.limit/1e8:0},sDTS=(s,t,a,e)=>{const r=+(s/t)*a;return sDV(formatMNDS(r),e),r},sDAPY=(s,t,a,e,r,c)=>{const D=getRAFD(a,+s*+t,e,r);sDV(D,c)},sDTSV=async(s,t,a,e)=>{let r,c;r="bnb"===e?bAOP(s):tAOPBD(s,e);let D=+(c=isKNA(e)?+r/1e6:+r/1e8)*a,d=supplyLBD(e,t),u={};return u[`${e}Usd`]=D,u[`${e}MC`]=formatMM(D),u[`${e}Supply`]=fMNDOL(c)+" "+dLab(e),u[`${e}AL`]=fMNDOL(d)+" "+dLab(e),u},getVRDFD=(s,t,a)=>{let e=s.result,r=0,c=Date.now();if(e){const s=e.usdx_minting_reward_periods.find(s=>s.collateral_type.toUpperCase()===t.toUpperCase());s&&(c=new Date(s.start).getTime(),r=s.rewards_per_second.amount);const a=Date.now()-c;kavaDistributed=+r*+(a/1e3)/1e6}return+kavaDistributed*+a},sUABD=(s,t,a)=>{const e=fMNDOL(t),r=fMNDOL(a),c=(100*(+t.toFixed(0)/+a.toFixed(0)).toFixed(3)).toFixed(2)+"%";$(`.percent-line-usdx-${s}`).css("width",c),sDV(e,`tb-${s}`),sDV(r,`bl-${s}`)},sDPD=(s,t)=>{let a;0>+s?(a=usdF.format(s).replace("$","")+"%",sDC("red",t)):(a="+"+formatMNDS(s)+"%",sDC("green",t)),sDV(a,t)},gSA=(s,t)=>{let a=0;const e=s.find(s=>s.denom===t);return e&&(a=e.amount),a},sUAL=s=>fMNDOL(+s.result.global_debt_limit.amount/1e6),sDV=(s,t)=>{$(`#${t}`).last().html(s),$(`#${t}`).first().html(s)},sDC=(s,t)=>{$(`#${t}`).css({color:s})},updateDV=async()=>{const[s,t,a,e,r,c,D,d,u,b,p,o,n,l,i,m,A,V,f]=await Promise.all([fetch(BINANACE_URL+"ticker/24hr?symbol=KAVAUSDT"),fetch(BINANACE_URL+"ticker/24hr?symbol=HARDUSDT"),fetch(BINANACE_URL+"ticker/24hr?symbol=BNBUSDT"),fetch(BINANACE_URL+"ticker/24hr?symbol=BUSDUSDT"),fetch(BINANACE_URL+"ticker/24hr?symbol=BTCUSDT"),fetch(BINANACE_URL+"ticker/24hr?symbol=XRPUSDT"),fetch("https://api.coingecko.com/api/v3/coins/usdx"),fetch(BASE_URL+"auth/accounts/kava1wq9ts6l7atfn45ryxrtg4a2gwegsh3xha9e6rp"),fetch(BASE_URL+"supply/total"),fetch(BASE_URL+"bep3/supplies"),fetch(BASE_URL+"bep3/parameters"),fetch(BASE_URL+"cdp/parameters"),fetch(BASE_URL+"incentive/parameters"),fetch(BASE_URL+"cdp/cdps/collateralType/bnb-a"),fetch(BASE_URL+"cdp/cdps/collateralType/busd-a"),fetch(BASE_URL+"cdp/cdps/collateralType/btcb-a"),fetch(BASE_URL+"cdp/cdps/collateralType/xrpb-a"),fetch(BASE_URL+"cdp/cdps/collateralType/ukava-a"),fetch(BASE_URL+"cdp/cdps/collateralType/hard-a")]),h=await s.json(),S=await t.json(),U=await a.json(),B=await e.json(),w=await r.json(),x=await c.json(),L=await D.json(),P=+h.lastPrice,k=await n.json(),_=getVRDFD(k,"bnb-a",P),F=getVRDFD(k,"busd-a",P),v=getVRDFD(k,"btcb-a",P),y=getVRDFD(k,"xrpb-a",P),T=getVRDFD(k,"ukava-a",P),g=getVRDFD(k,"hard-a",P),C=(await d.json()).result.value.coins,R=await u.json(),N=await b.json(),M=await p.json(),E=await o.json(),j=await l.json(),O=await i.json(),Y=await m.json(),I=await A.json(),K=await V.json(),X=await f.json();let H,q,z,G=await tLABBD(j.result,"bnb-a");G&&(H=G.locked,q=G.borrowed,z=G.fees);let J=await uDLBD("BNB-A",E),Q=sUA(J,q,z),W=+U.lastPrice;const Z=+U.priceChangePercent;let{bnbUsd:ss,bnbMC:ts,bnbSupply:as,bnbAL:es}=await sDTSV(N,M,W,"bnb");sDV(usdF.format(W),"price-bnb"),sDPD(Z,"pc-bnb");let rs=gSA(C,"bnb");const cs=sDTS(rs,1e8,W,"ts-bnb");sDTS(rs,1e8,W,"ts-m-bnb"),sDV(usdF.format(_),"te-bnb"),sDV(usdF.format(_),"te-m-bnb"),sDAPY(W,H,"bnb-a",P,k,"ea-bnb"),sDAPY(W,H,"bnb-a",P,k,"ea-m-bnb"),sUABD("bnb",Q,J);let Ds,ds,us,bs=await tLABBD(O.result,"busd-a");bs&&(Ds=bs.locked,ds=bs.borrowed,us=bs.fees);let ps=await uDLBD("BUSD-A",E),os=sUA(ps,ds,us),ns=+B.lastPrice;const ls=+B.priceChangePercent;let{busdUsd:is,busdMC:ms,busdSupply:As,busdAL:Vs}=await sDTSV(R,M,ns,"busd");sDV(usdF.format(ns),"price-busd"),sDPD(ls,"pc-busd");let fs=gSA(C,"busd");const hs=sDTS(fs,1e8,ns,"ts-busd");sDTS(fs,1e8,ns,"ts-m-busd"),sDV(usdF.format(F),"te-busd"),sDV(usdF.format(F),"te-m-busd"),sDAPY(ns,Ds,"busd-a",P,k,"ea-busd"),sDAPY(ns,Ds,"busd-a",P,k,"ea-m-busd"),sUABD("busd",os,ps);let Ss,Us,Bs,ws=await tLABBD(Y.result,"btcb-a");ws&&(Ss=ws.locked,Us=ws.borrowed,Bs=ws.fees);let xs=await uDLBD("BTCB-A",E),Ls=sUA(xs,Us,Bs),Ps=+w.lastPrice;const ks=+w.priceChangePercent;let{btcbUsd:_s,btcbMC:Fs,btcbSupply:vs,btcbAL:ys}=await sDTSV(R,M,Ps,"btcb");sDV(usdF.format(Ps),"price-btc"),sDPD(ks,"pc-btc");let Ts=gSA(C,"btcb");const gs=sDTS(Ts,1e8,Ps,"ts-btc");sDTS(Ts,1e8,Ps,"ts-m-btc"),sDV(usdF.format(v),"te-btc"),sDV(usdF.format(v),"te-m-btc"),sDAPY(Ps,Ss,"btcb-a",P,k,"ea-btc"),sDAPY(Ps,Ss,"btcb-a",P,k,"ea-m-btc"),sUABD("btc",Ls,xs);let Cs,Rs,Ns,Ms=await tLABBD(I.result,"xrpb-a");Ms&&(Cs=Ms.locked,Rs=Ms.borrowed,Ns=Ms.fees);let Es=await uDLBD("XRPB-A",E),js=sUA(Es,Rs,Ns),$s=+x.lastPrice;const Os=+x.priceChangePercent;let{xrpbUsd:Ys,xrpbMC:Is,xrpbSupply:Ks,xrpbAL:Xs}=await sDTSV(R,M,$s,"xrpb");sDV(usdF.format($s),"price-xrp"),sDPD(Os,"pc-xrp");let Hs=gSA(C,"xrpb");const qs=sDTS(Hs,1e8,$s,"ts-xrp");sDTS(Hs,1e8,$s,"ts-m-xrp"),sDV(usdF.format(y),"te-xrpb"),sDV(usdF.format(y),"te-m-xrpb"),sDAPY($s,Cs,"xrpb-a",P,k,"ea-xrp"),sDAPY($s,Cs,"xrpb-a",P,k,"ea-m-xrp"),sUABD("xrp",js,Es);let zs,Gs,Js,Qs=await tLABBD(K.result,"ukava-a");Qs&&(zs=Qs.locked,Gs=Qs.borrowed,Js=Qs.fees);let Ws=await uDLBD("UKAVA-A",E),Zs=sUA(Ws,Gs,Js);const st=+h.priceChangePercent;let{ukavaUsd:tt,ukavaMC:at,ukavaSupply:et}=await sDTSV(R,M,P,"ukava");sDV(usdF.format(P),"price-kava"),sDPD(st,"pc-kava");let rt=gSA(C,"ukava");const ct=sDTS(rt,1e6,P,"ts-kava");sDTS(rt,1e6,P,"ts-m-kava"),sDV(usdF.format(T),"te-kava"),sDV(usdF.format(T),"te-m-kava"),sDAPY(P,zs,"ukava-a",P,k,"ea-kava"),sDAPY(P,zs,"ukava-a",P,k,"ea-m-kava"),sUABD("kava",Zs,Ws);let Dt,dt,ut,bt=await tLABBD(X.result,"hard-a");bt&&(Dt=bt.locked,dt=bt.borrowed,ut=bt.fees);let pt=await uDLBD("HARD-A",E),ot=sUA(pt,dt,ut),nt=+S.lastPrice;const lt=+S.priceChangePercent;let{hardUsd:it,hardMC:mt,hardSupply:At}=await sDTSV(R,M,nt,"hard");sDV(usdF.format(nt),"price-hard"),sDPD(lt,"pc-hard");let Vt=gSA(C,"hard");const ft=sDTS(Vt,1e6,nt,"ts-hard");sDTS(Vt,1e6,nt,"ts-m-hard"),sDV(usdF.format(g),"te-hard"),sDV(usdF.format(g),"te-m-hard"),sDAPY(nt,Dt,"hard-a",P,k,"ea-hard"),sDAPY(nt,Dt,"hard-a",P,k,"ea-m-hard"),sUABD("hard",ot,pt),sDV(formatMNDS(cs+hs+gs+qs+ct+ft),"t-a-s"),sDV(formatMNDS(Q+Ls+os+js+Zs+ot),"t-a-b");const ht=L.market_data.current_price.usd,St=L.market_data.price_change_percentage_24h;let{usdxUsd:Ut,usdxMC:Bt,usdxSupply:wt}=await sDTSV(R,M,ht,"usdx");sDV(formatMNDS(ss+is+_s+Ys+tt+it+Ut),"t-m-c"),sDV(usdF.format(P),"price-d-kava"),sDPD(st,"pc-d-kava"),sDV(at,"mc-kava"),sDV(et,"s-kava"),sDV(usdF.format(P),"price-md-kava"),sDPD(st,"pc-md-kava"),sDV(at,"mc-m-kava"),sDV(et,"s-m-kava"),sDV(usdF.format(nt),"price-d-hard"),sDPD(lt,"pc-d-hard"),sDV(mt,"mc-hard"),sDV(At,"s-hard"),sDV(usdF.format(nt),"price-md-hard"),sDPD(lt,"pc-md-hard"),sDV(mt,"mc-m-hard"),sDV(At,"s-m-hard"),sDV(usdF.format(ht),"price-d-usdx"),sDPD(St,"pc-d-usdx"),sDV(Bt,"mc-usdx"),sDV(wt,"s-usdx"),sDV(sUAL(E)+" "+dLab("usdx"),"al-usdx"),sDV(usdF.format(ht),"price-md-usdx"),sDPD(St,"pc-md-usdx"),sDV(Bt,"mc-m-usdx"),sDV(wt,"s-m-usdx"),sDV(sUAL(E)+" "+dLab("usdx"),"al-m-usdx"),sDV(usdF.format(Ps),"price-d-btc"),sDPD(ks,"pc-d-btc"),sDV(Fs,"mc-btc"),sDV(vs,"s-btc"),sDV(ys,"al-btc"),sDV(usdF.format(Ps),"price-md-btc"),sDPD(ks,"pc-md-btc"),sDV(Fs,"mc-m-btc"),sDV(vs,"s-m-btc"),sDV(ys,"al-m-btc"),sDV(usdF.format($s),"price-d-xrp"),sDPD(Os,"pc-d-xrp"),sDV(Is,"mc-xrp"),sDV(Ks,"s-xrp"),sDV(Xs,"al-xrp"),sDV(usdF.format($s),"price-md-xrp"),sDPD(Os,"pc-md-xrp"),sDV(Is,"mc-m-xrp"),sDV(Ks,"s-m-xrp"),sDV(Xs,"al-m-xrp"),sDV(usdF.format(ns),"price-d-busd"),sDPD(ls,"pc-d-busd"),sDV(ms,"mc-busd"),sDV(As,"s-busd"),sDV(Vs,"al-busd"),sDV(usdF.format(ns),"price-md-busd"),sDPD(ls,"pc-md-busd"),sDV(ms,"mc-m-busd"),sDV(As,"s-m-busd"),sDV(Vs,"al-m-busd"),sDV(usdF.format(W),"price-d-bnb"),sDPD(Z,"pc-d-bnb"),sDV(ts,"mc-bnb"),sDV(as,"s-bnb"),sDV(es,"al-bnb"),sDV(usdF.format(W),"price-md-bnb"),sDPD(Z,"pc-md-bnb"),sDV(ts,"mc-m-bnb"),sDV(as,"s-m-bnb"),sDV(es,"al-m-bnb"),$(".metric-blur").css("background-color","transparent"),$(".metric-blur").addClass("without-after"),$(".api-metric").css({display:"block","text-align":"center"})},main=async()=>{await updateDV(),await sleep(6e4),main()},sleep=(s=1e4)=>new Promise(t=>setTimeout(t,s));main();
